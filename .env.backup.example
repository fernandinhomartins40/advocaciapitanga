# ============================================
# CONFIGURAÇÃO DE BACKUP AUTOMÁTICO
# ============================================
# Sistema de backup integrado para PostgreSQL
# Documentação completa em: BACKUP.md

# Habilitar/desabilitar sistema de backup (true/false)
# Padrão: true
BACKUP_ENABLED=true

# Diretório onde os backups serão salvos
# Em Docker: /app/backups (já configurado)
# Local: pode ser qualquer caminho absoluto
BACKUP_DIR=/app/backups

# Número máximo de backups a manter
# Os backups mais antigos serão deletados automaticamente
# Padrão: 7 (uma semana de backups diários)
MAX_BACKUPS=7

# Expressão cron para agendamento dos backups automáticos
# Formato: minuto hora dia mês dia-da-semana
# Exemplos:
#   0 3 * * *     = Todos os dias às 3:00 AM (PADRÃO)
#   0 */6 * * *   = A cada 6 horas
#   0 3,15 * * *  = Às 3:00 AM e 3:00 PM
#   0 2 * * 1     = Toda segunda-feira às 2:00 AM
#   0 1 1 * *     = Primeiro dia de cada mês às 1:00 AM
BACKUP_CRON_SCHEDULE=0 3 * * *

# Timezone para o agendamento
# Importante para garantir que os backups ocorram no horário correto
TZ=America/Sao_Paulo

# ============================================
# CLOUD BACKUP (OPCIONAL)
# ============================================
# Configuração para upload automático dos backups para cloud storage
# Se não configurado, os backups ficam apenas localmente

# Provider de cloud: aws-s3 | google-cloud | azure | none
# Padrão: none (desabilitado)
CLOUD_BACKUP_PROVIDER=none

# Nome do bucket/container no cloud storage
# AWS S3: nome do bucket
# Google Cloud: nome do bucket
# Azure: nome do container
CLOUD_BACKUP_BUCKET=advocacia-backups

# Região (principalmente para AWS S3)
# Exemplos: us-east-1, us-west-2, sa-east-1 (São Paulo)
CLOUD_BACKUP_REGION=us-east-1

# ============================================
# CREDENCIAIS AWS S3
# ============================================
# Necessário se CLOUD_BACKUP_PROVIDER=aws-s3
# Obtenha em: AWS Console > IAM > Users > Security credentials

AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE
AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY

# ============================================
# CREDENCIAIS GOOGLE CLOUD STORAGE
# ============================================
# Necessário se CLOUD_BACKUP_PROVIDER=google-cloud
# Caminho para o arquivo JSON de service account
# Obtenha em: Google Cloud Console > IAM > Service Accounts

GOOGLE_APPLICATION_CREDENTIALS=/app/config/gcloud-service-account.json

# ============================================
# CREDENCIAIS AZURE BLOB STORAGE
# ============================================
# Necessário se CLOUD_BACKUP_PROVIDER=azure
# Configure via Azure CLI: az storage account keys list
# Ou use connection string diretamente

AZURE_STORAGE_ACCOUNT=advocaciaaccount
AZURE_STORAGE_KEY=sua-chave-azure-aqui

# ============================================
# NOTAS IMPORTANTES
# ============================================

# 1. SEGURANÇA
#    - Mantenha este arquivo fora do controle de versão (.gitignore)
#    - Use secrets/vault em produção para credenciais sensíveis
#    - Restrinja acesso ao diretório de backups

# 2. ESPAÇO EM DISCO
#    - Cada backup pode ter ~25-50MB (dependendo dos dados)
#    - 7 backups = ~175-350MB de espaço necessário
#    - Monitore o espaço disponível regularmente

# 3. CLOUD STORAGE
#    - Backups locais + cloud = redundância máxima
#    - Cloud backups também mantêm os 7 mais recentes
#    - Configure lifecycle policies no bucket para economia

# 4. TESTES
#    - Teste o restore regularmente (mensal recomendado)
#    - Valide backups antes de deployments importantes
#    - Mantenha backup off-site sempre

# 5. MONITORAMENTO
#    - Verifique logs de backup: docker logs advocacia-app | grep backup
#    - Configure alertas para falhas de backup
#    - Use endpoint /api/backups/stats para monitorar

# ============================================
# EXEMPLOS DE CONFIGURAÇÃO
# ============================================

# DESENVOLVIMENTO (Backup local apenas, a cada 12 horas)
# BACKUP_ENABLED=true
# MAX_BACKUPS=3
# BACKUP_CRON_SCHEDULE=0 */12 * * *
# CLOUD_BACKUP_PROVIDER=none

# PRODUÇÃO (Backup diário com cloud)
# BACKUP_ENABLED=true
# MAX_BACKUPS=7
# BACKUP_CRON_SCHEDULE=0 3 * * *
# CLOUD_BACKUP_PROVIDER=aws-s3
# CLOUD_BACKUP_BUCKET=advocacia-prod-backups
# AWS_ACCESS_KEY_ID=...
# AWS_SECRET_ACCESS_KEY=...

# STAGING (Backup semanal)
# BACKUP_ENABLED=true
# MAX_BACKUPS=4
# BACKUP_CRON_SCHEDULE=0 2 * * 0
# CLOUD_BACKUP_PROVIDER=none
